# Что это

Это класс ImageParser, с помощью которого, можно по заданным тегам 
парсить открытые (декларирующие возможность свободного использования) 
источники картинок. 
Для каждого из источников используется отдельный плагин. 

## Как пользоваться

Посмотреть пример использования можно в файле [`sample.py`](sample.py).
Общий порядок использования такой:

1. Установите зависимости из [`req.txt`](req.txt): `pip install -r req.txt`
2. Импортируйте класс `ImageParser` из файла [`image_parser.py`](image_parser.py)
3. Создайте экземпляр класса `ImageParser`, передав в него словарь тегов, 
по которым будет производиться поиск.
В конструктор класса `ImageParser` в качестве параметра 
`input_data` передавайте словарь вида  `dict[str: tuple[int, int]]`,
где ключом выступает имя тега, а элементы кортежа - требуемое 
количество изображений для обучающей и тестовой выборок. Также в качестве необязательного
параметра принимает список названий плагинов. Если он указан, то будут задействованы 
только плагины из списка, иначе - все доступные
4. Вызовите метод `get_data()`, чтобы скачать картинки по заданным тегам
всеми доступными плагинами
5. Вызовите метод `load_data()`, чтобы получить скачанные картинки в формате,
пригодном для использования в библиотеках PyTorch и TensorFlow.
В качестве аргументов метода можно указать `height` - 
требуемую высоту картинки и `crop_width` - её максимальную ширину.
У картинок, ширина который меньше `crop_width`, соответствующие точки
будут заполнены нулевыми значениями.

## Ограничения
- На данный момент все плагины используют источники, доступные только через сервисы VPN
- На данный момент плагин [`Pixabay`](plugins/pixabay.py), использующий Selenium, не может работать в headless
и, соответственно, требует установленного Chrome.
- Плагин [`Pexels`](plugins/pexels.py) использует бесплатное API и имеет ограничение на 200 запросов в час и 20000
запросов в месяц.
- Плагин [`Unsplash`](plugins/unsplash.py) использует демо-режим API и имеет ограничение на 50 запросов в час. Также в политике
  использования данным плагином указано, что API не может использоваться для обучения нейронных сетей
- В данных могут возникать несоответствия между тегом и фактическим содержимым картинки
из-за несовершенства выдачи галерей

## Формат возвращаемых наборов данных

В соответствии с требованиями данные, возвращаемые методом `load_data()`
пригодны для прямой передачи в PyTorch и TensorFlow без дополнительных 
преобразований.
Результат исполнения в виде `(np.array, np.array, np.array, np.array)` 
представляет собой набор из следующих массивов:

- данные, на которых обучаемся, 
- ответы к этим данным
- данные, на которых тестируемся
- ответы к этим данным

## Как добавить свой плагин

1. Создайте отдельный `pluginame.py` файл для вашего плагина 
2. Создайте класс, наследованный от класса `Plugin`, расположенного в корне проекта, реализуйте необходимые методы
3. Добавьте свой файл с плагином в папку [`plugins`](plugins). 

## Текущие необходимые улучшения:

- Создать больше плагинов, проверить работоспособность плагинов с Selenium под Linux 
- Запускать плагины асинхронно (может приводить к блокировкам со стороны галерей)
- Убрать ключи API из исходных кодов плагинов в vault
- Добавить тесты для плагинов
- Более скрупулезно  обрабатыватьошибки в плагинах
